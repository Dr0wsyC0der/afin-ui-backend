# Решение проблемы входа в систему

## Проблема: Не могу войти в систему

### Шаг 1: Проверьте, что backend запущен

```powershell
# Проверка порта
netstat -ano | findstr ":8000"
```

Если порт не слушается, запустите backend:

```powershell
cd afin-backend
.\start_backend.ps1
```

Или вручную:
```powershell
cd afin-backend\services\gateway
uvicorn main:app --host 0.0.0.0 --port 8000 --reload
```

### Шаг 2: Создайте пользователя

#### Вариант A: Через веб-интерфейс (самый простой)

1. Откройте браузер: http://localhost:8000/docs
2. Найдите endpoint `/api/auth/register`
3. Нажмите "Try it out"
4. Введите данные:
   ```json
   {
     "email": "admin@afin.ru",
     "password": "password123",
     "firstName": "Admin",
     "lastName": "User"
   }
   ```
5. Нажмите "Execute"

#### Вариант B: Через PowerShell

```powershell
$body = @{
    email = "admin@afin.ru"
    password = "password123"
    firstName = "Admin"
    lastName = "User"
} | ConvertTo-Json

Invoke-RestMethod -Uri "http://localhost:8000/api/auth/register" `
    -Method POST `
    -ContentType "application/json" `
    -Body $body
```

#### Вариант C: Через Python скрипт

```powershell
cd afin-backend
python create_user_via_api.py
```

### Шаг 3: Войдите в систему

После создания пользователя используйте:
- **Email:** `admin@afin.ru`
- **Пароль:** `password123`

### Шаг 4: Проверьте frontend

Убедитесь, что frontend запущен и указывает на правильный backend:

1. Проверьте файл `.env` в `afin-frontend/frontend/`:
   ```
   VITE_API_BASE_URL=http://localhost:8000
   ```

2. Запустите frontend:
   ```powershell
   cd afin-frontend/frontend
   npm run dev
   ```

3. Откройте http://localhost:5173 (или порт, который покажет Vite)

## Если ничего не помогает

1. **Перезапустите backend:**
   - Остановите процесс (Ctrl+C)
   - Запустите заново: `uvicorn main:app --host 0.0.0.0 --port 8000 --reload`

2. **Проверьте базу данных:**
   - Убедитесь, что файл `afin-backend/storage/afin.db` существует
   - Если нет, создайте директорию: `mkdir afin-backend\storage`

3. **Проверьте логи backend:**
   - В консоли, где запущен backend, должны быть сообщения об ошибках

4. **Проверьте переменные окружения:**
   - Создайте файл `afin-backend/.env`:
     ```
     DATABASE_URL=sqlite:///./storage/afin.db
     JWT_SECRET=super-secret-jwt-key-change-in-prod
     ```

## Быстрая проверка

Откройте в браузере:
- http://localhost:8000/health - должен вернуть `{"status":"ok","service":"gateway"}`
- http://localhost:8000/docs - должна открыться документация API

Если эти страницы не открываются, backend не запущен или работает неправильно.





